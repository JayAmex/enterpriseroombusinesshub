<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Register Your Business | Enterprise Room Business Hub</title>
    <link rel="icon" type="image/jpeg" href="assets/logo.jpg">
    <script>
        // Check authentication before page loads
        (function() {
            if (sessionStorage.getItem('userAuthenticated') !== 'true') {
                sessionStorage.setItem('redirectAfterLogin', 'register-business.html');
                window.location.replace('login.html');
                return;
            }
        })();
    </script>
    <link rel="stylesheet" href="css/styles.css">
    <style>
        /* Page-specific styles */
        .container {
            max-width: 800px;
            margin: 50px auto;
            background: var(--white);
            padding: 40px;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.05);
        }

        .subtitle {
            text-align: center;
            color: var(--text-light);
            margin-bottom: 30px;
        }

        .form-section {
            display: none;
        }

        .form-section.active {
            display: block;
        }

        .step-indicator {
            display: flex;
            justify-content: space-between;
            margin-bottom: 30px;
            position: relative;
        }

        .step-indicator::before {
            content: '';
            position: absolute;
            top: 20px;
            left: 0;
            right: 0;
            height: 2px;
            background: var(--light);
            z-index: 0;
        }

        .step {
            flex: 1;
            text-align: center;
            position: relative;
            z-index: 1;
        }

        .step-number {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--light);
            color: var(--text-light);
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 10px;
            font-weight: bold;
            transition: all 0.3s;
        }

        .step.active .step-number {
            background: var(--primary);
            color: var(--white);
        }

        .step-label {
            font-size: 0.85rem;
            color: var(--text-light);
        }

        .step.active .step-label {
            color: var(--primary);
            font-weight: 600;
        }

        .btn-nav {
            display: flex;
            justify-content: space-between;
            margin-top: 30px;
        }

        .newsletter-optin {
            display: flex;
            align-items: center;
            gap: 10px;
            margin: 20px 0;
            padding: 15px;
            background: var(--light);
            border-radius: 8px;
        }
    </style>
</head>
<body>
    <nav>
        <div class="nav-container">
            <div class="logo">
                <img src="assets/logo.jpg" alt="Enterprise Room Business Hub Logo">
                <span>Enterprise Room Business Hub</span>
            </div>
            <ul class="nav-links">
                <li><a href="index.html">Home</a></li>
                <li><a href="about.html">About</a></li>
                <li><a href="eventspage.html">Events</a></li>
                <li><a href="blog.html">Blog</a></li>
                <li><a href="directories.html">Directories</a></li>
                <li><a href="tools.html">Tools</a></li>
                <li><a href="faq.html">FAQ</a></li>
                <li><a href="contact.html">Contact</a></li>
                <li><a href="profile.html" id="navProfileLink"><span>My Profile</span></a></li>
            </ul>
            <button class="mobile-nav-toggle" aria-label="Toggle navigation">
                <span></span>
                <span></span>
                <span></span>
            </button>
        </div>
    </nav>

<div class="breadcrumbs">
    <a href="index.html">Home</a>
    <span>/</span>
    <span>Register Business</span>
</div>

<div class="container">
    <h1 style="text-align: center;">Register Your Business</h1>
    <p class="subtitle">Complete the form to register your business on the platform.</p>

    <div class="step-indicator">
        <div class="step active" data-step="1">
            <div class="step-number">1</div>
            <div class="step-label">Owner Info</div>
        </div>
        <div class="step" data-step="2">
            <div class="step-number">2</div>
            <div class="step-label">Business Details</div>
        </div>
        <div class="step" data-step="3">
            <div class="step-number">3</div>
            <div class="step-label">Verification</div>
        </div>
    </div>
    <div style="text-align: center; margin: 20px 0;">
        <div style="background: var(--light); height: 4px; border-radius: 2px; max-width: 600px; margin: 0 auto;">
            <div id="progressBar" style="background: var(--success); height: 100%; width: 33%; border-radius: 2px; transition: width 0.3s;"></div>
        </div>
        <p style="margin-top: 10px; color: var(--text-light); font-size: 0.9rem;">Step <span id="currentStep">1</span> of 3</p>
    </div>

    <form id="businessForm">
        <div class="form-section active" id="step1">
            <h3>Step 1: Owner Information</h3>
            <p style="color: var(--text-light); margin-bottom: 20px; font-size: 0.9rem;">Tell us about your relationship to the business.</p>
            <div class="input-group">
                <label>Full Name</label>
                <input type="text" id="ownerName" placeholder="Loading..." readonly style="background: var(--light); cursor: not-allowed;">
                <small style="color: var(--text-light); font-size: 0.85rem; margin-top: 5px; display: block;">This is imported from your profile.</small>
            </div>
            <div class="input-group">
                <label>Relationship to Business</label>
                <select id="ownerRelationship" required>
                    <option value="">Select Relationship</option>
                    <option>Owner/Founder</option>
                    <option>Co-Founder</option>
                    <option>Director</option>
                    <option>Manager</option>
                    <option>Authorized Representative</option>
                    <option>Other</option>
                </select>
            </div>
            <div class="btn-nav">
                <div></div>
                <button type="button" class="btn btn-next" onclick="nextStep(2)">Next: Business Details</button>
            </div>
        </div>

        <div class="form-section" id="step2">
            <h3>Step 2: Business Details</h3>
            <div class="input-group">
                <label>Business Name</label>
                <input type="text" id="businessName" placeholder="Enter business name" required>
            </div>
            <div class="input-group">
                <label>Business Address</label>
                <textarea id="businessAddress" rows="3" placeholder="Enter complete business address" required></textarea>
            </div>
            <div class="input-group">
                <label>Business Sector</label>
                <select id="businessSector" required>
                    <option value="">Select Business Sector</option>
                    <option>Agriculture</option>
                    <option>Fashion</option>
                    <option>Technology</option>
                    <option>Logistics (Trailer/Transport)</option>
                    <option>Retail</option>
                    <option>Finance</option>
                    <option>Healthcare</option>
                    <option>Education</option>
                    <option>Manufacturing</option>
                    <option>Real Estate</option>
                    <option>Food & Beverage</option>
                    <option>Construction</option>
                    <option>Entertainment</option>
                    <option>Consulting</option>
                    <option>Other</option>
                </select>
            </div>
            <div class="input-group">
                <label>Year of Formation</label>
                <input type="number" id="yearOfFormation" placeholder="e.g. 2020" min="1900" max="2026" required>
            </div>
            <div class="input-group">
                <label>Number of Employees</label>
                <input type="number" id="numberOfEmployees" placeholder="e.g. 10" min="1" required>
            </div>
            <div class="input-group">
                <label>Registered with CAC</label>
                <select id="cacRegistered" required onchange="toggleCACUpload()">
                    <option value="">Select</option>
                    <option value="yes">Yes</option>
                    <option value="no">No</option>
                </select>
            </div>
            <div class="input-group" id="cacUploadSection" style="display: none;">
                <label>CAC Certificate</label>
                <input type="file" id="cacCertificate" accept=".pdf,.jpg,.jpeg,.png" onchange="handleCACUpload(event)">
                <small style="color: var(--text-light); font-size: 0.85rem; margin-top: 5px; display: block;">Upload your CAC certificate for business verification. Businesses with verified CAC certificates will be designated as "Verified Business".</small>
                <div id="cacPreview" style="margin-top: 10px; display: none;">
                    <p style="color: var(--success); font-size: 0.9rem;">✓ Certificate uploaded</p>
                </div>
            </div>
            <div class="input-group">
                <label>Does Business have a designated Business Bank account?</label>
                <select id="hasBusinessBankAccount" required onchange="toggleBankDetails()">
                    <option value="">Select</option>
                    <option value="yes">Yes</option>
                    <option value="no">No</option>
                </select>
            </div>
            <div id="bankDetailsSection" style="display: none;">
                <div class="input-group">
                    <label>Bank Name</label>
                    <input type="text" id="bankName" placeholder="Enter bank name">
                </div>
                <div class="input-group">
                    <label>Account Number</label>
                    <input type="text" id="accountNumber" placeholder="Enter account number">
                </div>
                <div class="input-group">
                    <label>Account Name</label>
                    <input type="text" id="accountName" placeholder="Enter account name">
                </div>
            </div>
            <div class="btn-nav">
                <button type="button" class="btn btn-prev" onclick="nextStep(1)">Back</button>
                <button type="button" class="btn btn-next" onclick="nextStep(3)">Next: Review</button>
            </div>
        </div>

        <div class="form-section" id="step3">
            <h3>Step 3: Review & Submit</h3>
            <p style="color: var(--text-light); margin-bottom: 20px; font-size: 0.9rem;">Please review your information before submitting.</p>
            <div id="reviewSummary" style="background: var(--light); padding: 20px; border-radius: 8px; margin-bottom: 20px;">
                <!-- Review summary will be populated here -->
            </div>
            <div class="newsletter-optin">
                <input type="checkbox" id="newsletter" style="width: auto;">
                <label for="newsletter" style="margin: 0;">Add my business to the Newsletter & Mailshot Database</label>
            </div>
            <div class="btn-nav">
                <button type="button" class="btn btn-prev" onclick="nextStep(2)">Back</button>
                <button type="submit" class="btn btn-success">Register Business</button>
            </div>
        </div>
    </form>
</div>

<footer>
    <p>&copy; 2026 Enterprise Room Business Hub. All Rights Reserved.</p>
</footer>

<script src="js/common.js"></script>
<script>
    function validateStep(stepNumber) {
        const step = document.getElementById('step' + stepNumber);
        const inputs = step.querySelectorAll('input[required], select[required], textarea[required]');
        let isValid = true;
        
        inputs.forEach(input => {
            if (!input.value.trim()) {
                isValid = false;
                input.style.borderColor = 'var(--live)';
                input.addEventListener('input', function() {
                    this.style.borderColor = '';
                }, { once: true });
            } else {
                input.style.borderColor = '';
            }
        });
        
        return isValid;
    }
    
    function nextStep(stepNumber) {
        // Validate current step before proceeding
        const currentStep = Array.from(document.querySelectorAll('.form-section')).findIndex(s => s.classList.contains('active')) + 1;
        if (stepNumber > currentStep && !validateStep(currentStep)) {
            alert('Please fill in all required fields before proceeding.');
            return;
        }
        
        // Hide all sections
        document.querySelectorAll('.form-section').forEach(section => {
            section.classList.remove('active');
        });
        // Show target section
        document.getElementById('step' + stepNumber).classList.add('active');
        
        // Update progress bar
        const progress = (stepNumber / 3) * 100;
        document.getElementById('progressBar').style.width = progress + '%';
        document.getElementById('currentStep').textContent = stepNumber;
        
        // If moving to step 3, populate review summary
        if (stepNumber === 3) {
            populateReviewSummary();
        }
        
        // Update indicators
        const steps = document.querySelectorAll('.step');
        steps.forEach((step, index) => {
            if (index + 1 <= stepNumber) {
                step.classList.add('active');
            } else {
                step.classList.remove('active');
            }
        });
        
        // Scroll to top of form
        document.getElementById('businessForm').scrollIntoView({ behavior: 'smooth', block: 'start' });
    }

    // Load user name from profile
    function loadUserName() {
        const userName = sessionStorage.getItem('userName');
        const userEmail = sessionStorage.getItem('userEmail');
        const registeredUsers = JSON.parse(localStorage.getItem('registeredUsers') || '{}');
        const userData = registeredUsers[userEmail];
        
        const ownerNameInput = document.getElementById('ownerName');
        if (ownerNameInput) {
            const name = userName || userData?.name || 'User';
            ownerNameInput.value = name;
        }
    }
    
    // Toggle CAC upload section
    function toggleCACUpload() {
        const cacRegistered = document.getElementById('cacRegistered').value;
        const cacUploadSection = document.getElementById('cacUploadSection');
        const cacCertificate = document.getElementById('cacCertificate');
        
        if (cacRegistered === 'yes') {
            cacUploadSection.style.display = 'block';
            cacCertificate.required = true;
        } else {
            cacUploadSection.style.display = 'none';
            cacCertificate.required = false;
            cacCertificate.value = '';
            document.getElementById('cacPreview').style.display = 'none';
        }
    }
    
    // Handle CAC certificate upload
    let cacCertificateData = null;
    function handleCACUpload(event) {
        const file = event.target.files[0];
        if (!file) return;
        
        // Validate file type
        const allowedTypes = ['application/pdf', 'image/jpeg', 'image/jpg', 'image/png'];
        if (!allowedTypes.includes(file.type)) {
            alert('Please upload a PDF, JPG, or PNG file.');
            event.target.value = '';
            return;
        }
        
        // Validate file size (max 5MB)
        if (file.size > 5 * 1024 * 1024) {
            alert('File size must be less than 5MB.');
            event.target.value = '';
            return;
        }
        
        const reader = new FileReader();
        reader.onload = function(e) {
            cacCertificateData = e.target.result;
            document.getElementById('cacPreview').style.display = 'block';
        };
        reader.readAsDataURL(file);
    }
    
    // Toggle bank details section
    function toggleBankDetails() {
        const hasBankAccount = document.getElementById('hasBusinessBankAccount').value;
        const bankDetailsSection = document.getElementById('bankDetailsSection');
        
        if (hasBankAccount === 'yes') {
            bankDetailsSection.style.display = 'block';
        } else {
            bankDetailsSection.style.display = 'none';
            // Clear bank details
            document.getElementById('bankName').value = '';
            document.getElementById('accountNumber').value = '';
            document.getElementById('accountName').value = '';
        }
    }
    
    // Populate review summary
    function populateReviewSummary() {
        const reviewSummary = document.getElementById('reviewSummary');
        const ownerName = document.getElementById('ownerName').value;
        const ownerRelationship = document.getElementById('ownerRelationship').value;
        const businessName = document.getElementById('businessName').value;
        const businessAddress = document.getElementById('businessAddress').value;
        const businessSector = document.getElementById('businessSector').value;
        const yearOfFormation = document.getElementById('yearOfFormation').value;
        const numberOfEmployees = document.getElementById('numberOfEmployees').value;
        const cacRegistered = document.getElementById('cacRegistered').value;
        const hasBankAccount = document.getElementById('hasBusinessBankAccount').value;
        
        reviewSummary.innerHTML = `
            <h4 style="margin-top: 0; color: var(--primary);">Owner Information</h4>
            <p><strong>Name:</strong> ${ownerName}</p>
            <p><strong>Relationship:</strong> ${ownerRelationship || 'Not specified'}</p>
            
            <h4 style="margin-top: 20px; color: var(--primary);">Business Information</h4>
            <p><strong>Business Name:</strong> ${businessName || 'Not specified'}</p>
            <p><strong>Address:</strong> ${businessAddress || 'Not specified'}</p>
            <p><strong>Sector:</strong> ${businessSector || 'Not specified'}</p>
            <p><strong>Year of Formation:</strong> ${yearOfFormation || 'Not specified'}</p>
            <p><strong>Number of Employees:</strong> ${numberOfEmployees || 'Not specified'}</p>
            <p><strong>CAC Registered:</strong> ${cacRegistered === 'yes' ? 'Yes' : cacRegistered === 'no' ? 'No' : 'Not specified'}</p>
            ${cacRegistered === 'yes' && cacCertificateData ? '<p><strong>CAC Certificate:</strong> ✓ Uploaded</p>' : ''}
            <p><strong>Business Bank Account:</strong> ${hasBankAccount === 'yes' ? 'Yes' : hasBankAccount === 'no' ? 'No' : 'Not specified'}</p>
        `;
    }

    document.getElementById('businessForm').onsubmit = function(e) {
        e.preventDefault();
        
        // Get current user email
        const userEmail = sessionStorage.getItem('userEmail');
        if (!userEmail) {
            alert('Error: You must be logged in to register a business.');
            window.location.href = 'login.html';
            return;
        }
        
        // Collect business data
        const businessData = {
            businessName: document.getElementById('businessName').value.trim(),
            businessAddress: document.getElementById('businessAddress').value.trim(),
            businessSector: document.getElementById('businessSector').value.trim(),
            yearOfFormation: document.getElementById('yearOfFormation').value.trim(),
            numberOfEmployees: parseInt(document.getElementById('numberOfEmployees').value) || 0,
            cacRegistered: document.getElementById('cacRegistered').value,
            cacCertificate: cacCertificateData || null,
            hasBusinessBankAccount: document.getElementById('hasBusinessBankAccount').value,
            bankName: document.getElementById('bankName')?.value.trim() || '',
            accountNumber: document.getElementById('accountNumber')?.value.trim() || '',
            accountName: document.getElementById('accountName')?.value.trim() || '',
            ownerName: document.getElementById('ownerName').value.trim(),
            ownerRelationship: document.getElementById('ownerRelationship').value.trim(),
            newsletter: document.getElementById('newsletter').checked,
            registeredDate: new Date().toISOString().split('T')[0],
            status: cacCertificateData ? 'Verified Business' : 'Pending Review',
            ownerEmail: userEmail // Link business to user
        };
        
        // Validate required fields
        if (!businessData.businessName || !businessData.businessAddress || !businessData.businessSector || 
            !businessData.yearOfFormation || !businessData.numberOfEmployees || !businessData.ownerRelationship) {
            alert('Please fill in all required fields.');
            return;
        }
        
        // Save business data to localStorage
        // Structure: { userEmail: [business1, business2, ...] }
        let businesses = JSON.parse(localStorage.getItem('registeredBusinesses') || '{}');
        
        // Generate unique ID for this business
        businessData.id = Date.now().toString() + Math.random().toString(36).substr(2, 9);
        
        // Initialize array if user has no businesses yet
        if (!businesses[userEmail]) {
            businesses[userEmail] = [];
        }
        
        // Add new business to user's business array
        businesses[userEmail].push(businessData);
        localStorage.setItem('registeredBusinesses', JSON.stringify(businesses));
        
        alert("Business registered successfully! Your business has been added to our database.");
        window.location.href = 'profile.html';
    };
    
    // Load user name on page load
    window.addEventListener('DOMContentLoaded', function() {
        loadUserName();
    });
</script>

</body>
</html>


<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Register Your Business | Enterprise Room Business Hub</title>
    <link rel="icon" type="image/jpeg" href="assets/logo.jpg">
    <script>
        // Check authentication before page loads
        (function() {
            if (sessionStorage.getItem('userAuthenticated') !== 'true') {
                sessionStorage.setItem('redirectAfterLogin', 'register-business.html');
                window.location.replace('login.html');
                return;
            }
        })();
    </script>
    <link rel="stylesheet" href="css/styles.css">
    <style>
        /* Page-specific styles */
        .container {
            max-width: 800px;
            margin: 50px auto;
            background: var(--white);
            padding: 40px;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.05);
        }

        .subtitle {
            text-align: center;
            color: var(--text-light);
            margin-bottom: 30px;
        }

        .form-section {
            display: none;
        }

        .form-section.active {
            display: block;
        }

        .step-indicator {
            display: flex;
            justify-content: space-between;
            margin-bottom: 30px;
            position: relative;
        }

        .step-indicator::before {
            content: '';
            position: absolute;
            top: 20px;
            left: 0;
            right: 0;
            height: 2px;
            background: var(--light);
            z-index: 0;
        }

        .step {
            flex: 1;
            text-align: center;
            position: relative;
            z-index: 1;
        }

        .step-number {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--light);
            color: var(--text-light);
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 10px;
            font-weight: bold;
            transition: all 0.3s;
        }

        .step.active .step-number {
            background: var(--primary);
            color: var(--white);
        }

        .step-label {
            font-size: 0.85rem;
            color: var(--text-light);
        }

        .step.active .step-label {
            color: var(--primary);
            font-weight: 600;
        }

        .btn-nav {
            display: flex;
            justify-content: space-between;
            margin-top: 30px;
        }

        .newsletter-optin {
            display: flex;
            align-items: center;
            gap: 10px;
            margin: 20px 0;
            padding: 15px;
            background: var(--light);
            border-radius: 8px;
        }
    </style>
</head>
<body>
    <nav>
        <div class="nav-container">
            <div class="logo">
                <img src="assets/logo.jpg" alt="Enterprise Room Business Hub Logo">
                <span>Enterprise Room Business Hub</span>
            </div>
            <ul class="nav-links">
                <li><a href="index.html">Home</a></li>
                <li><a href="about.html">About</a></li>
                <li><a href="eventspage.html">Events</a></li>
                <li><a href="blog.html">Blog</a></li>
                <li><a href="directories.html">Directories</a></li>
                <li><a href="tools.html">Tools</a></li>
                <li><a href="faq.html">FAQ</a></li>
                <li><a href="contact.html">Contact</a></li>
                <li><a href="profile.html" id="navProfileLink"><span>My Profile</span></a></li>
            </ul>
            <button class="mobile-nav-toggle" aria-label="Toggle navigation">
                <span></span>
                <span></span>
                <span></span>
            </button>
        </div>
    </nav>

<div class="breadcrumbs">
    <a href="index.html">Home</a>
    <span>/</span>
    <span>Register Business</span>
</div>

<div class="container">
    <h1 style="text-align: center;">Register Your Business</h1>
    <p class="subtitle">Complete the form to register your business on the platform.</p>

    <div class="step-indicator">
        <div class="step active" data-step="1">
            <div class="step-number">1</div>
            <div class="step-label">Owner Info</div>
        </div>
        <div class="step" data-step="2">
            <div class="step-number">2</div>
            <div class="step-label">Business Details</div>
        </div>
        <div class="step" data-step="3">
            <div class="step-number">3</div>
            <div class="step-label">Verification</div>
        </div>
    </div>
    <div style="text-align: center; margin: 20px 0;">
        <div style="background: var(--light); height: 4px; border-radius: 2px; max-width: 600px; margin: 0 auto;">
            <div id="progressBar" style="background: var(--success); height: 100%; width: 33%; border-radius: 2px; transition: width 0.3s;"></div>
        </div>
        <p style="margin-top: 10px; color: var(--text-light); font-size: 0.9rem;">Step <span id="currentStep">1</span> of 3</p>
    </div>

    <form id="businessForm">
        <div class="form-section active" id="step1">
            <h3>Step 1: Owner Information</h3>
            <p style="color: var(--text-light); margin-bottom: 20px; font-size: 0.9rem;">Tell us about your relationship to the business.</p>
            <div class="input-group">
                <label>Full Name</label>
                <input type="text" id="ownerName" placeholder="Loading..." readonly style="background: var(--light); cursor: not-allowed;">
                <small style="color: var(--text-light); font-size: 0.85rem; margin-top: 5px; display: block;">This is imported from your profile.</small>
            </div>
            <div class="input-group">
                <label>Relationship to Business</label>
                <select id="ownerRelationship" required>
                    <option value="">Select Relationship</option>
                    <option>Owner/Founder</option>
                    <option>Co-Founder</option>
                    <option>Director</option>
                    <option>Manager</option>
                    <option>Authorized Representative</option>
                    <option>Other</option>
                </select>
            </div>
            <div class="btn-nav">
                <div></div>
                <button type="button" class="btn btn-next" onclick="nextStep(2)">Next: Business Details</button>
            </div>
        </div>

        <div class="form-section" id="step2">
            <h3>Step 2: Business Details</h3>
            <div class="input-group">
                <label>Business Name</label>
                <input type="text" id="businessName" placeholder="Enter business name" required>
            </div>
            <div class="input-group">
                <label>Business Address</label>
                <textarea id="businessAddress" rows="3" placeholder="Enter complete business address" required></textarea>
            </div>
            <div class="input-group">
                <label>Business Sector</label>
                <select id="businessSector" required>
                    <option value="">Select Business Sector</option>
                    <option>Agriculture</option>
                    <option>Fashion</option>
                    <option>Technology</option>
                    <option>Logistics (Trailer/Transport)</option>
                    <option>Retail</option>
                    <option>Finance</option>
                    <option>Healthcare</option>
                    <option>Education</option>
                    <option>Manufacturing</option>
                    <option>Real Estate</option>
                    <option>Food & Beverage</option>
                    <option>Construction</option>
                    <option>Entertainment</option>
                    <option>Consulting</option>
                    <option>Other</option>
                </select>
            </div>
            <div class="input-group">
                <label>Year of Formation</label>
                <input type="number" id="yearOfFormation" placeholder="e.g. 2020" min="1900" max="2026" required>
            </div>
            <div class="input-group">
                <label>Number of Employees</label>
                <input type="number" id="numberOfEmployees" placeholder="e.g. 10" min="1" required>
            </div>
            <div class="input-group">
                <label>Registered with CAC</label>
                <select id="cacRegistered" required onchange="toggleCACUpload()">
                    <option value="">Select</option>
                    <option value="yes">Yes</option>
                    <option value="no">No</option>
                </select>
            </div>
            <div class="input-group" id="cacUploadSection" style="display: none;">
                <label>CAC Certificate</label>
                <input type="file" id="cacCertificate" accept=".pdf,.jpg,.jpeg,.png" onchange="handleCACUpload(event)">
                <small style="color: var(--text-light); font-size: 0.85rem; margin-top: 5px; display: block;">Upload your CAC certificate for business verification. Businesses with verified CAC certificates will be designated as "Verified Business".</small>
                <div id="cacPreview" style="margin-top: 10px; display: none;">
                    <p style="color: var(--success); font-size: 0.9rem;">✓ Certificate uploaded</p>
                </div>
            </div>
            <div class="input-group">
                <label>Does Business have a designated Business Bank account?</label>
                <select id="hasBusinessBankAccount" required onchange="toggleBankDetails()">
                    <option value="">Select</option>
                    <option value="yes">Yes</option>
                    <option value="no">No</option>
                </select>
            </div>
            <div id="bankDetailsSection" style="display: none;">
                <div class="input-group">
                    <label>Bank Name</label>
                    <input type="text" id="bankName" placeholder="Enter bank name">
                </div>
                <div class="input-group">
                    <label>Account Number</label>
                    <input type="text" id="accountNumber" placeholder="Enter account number">
                </div>
                <div class="input-group">
                    <label>Account Name</label>
                    <input type="text" id="accountName" placeholder="Enter account name">
                </div>
            </div>
            <div class="btn-nav">
                <button type="button" class="btn btn-prev" onclick="nextStep(1)">Back</button>
                <button type="button" class="btn btn-next" onclick="nextStep(3)">Next: Review</button>
            </div>
        </div>

        <div class="form-section" id="step3">
            <h3>Step 3: Review & Submit</h3>
            <p style="color: var(--text-light); margin-bottom: 20px; font-size: 0.9rem;">Please review your information before submitting.</p>
            <div id="reviewSummary" style="background: var(--light); padding: 20px; border-radius: 8px; margin-bottom: 20px;">
                <!-- Review summary will be populated here -->
            </div>
            <div class="newsletter-optin">
                <input type="checkbox" id="newsletter" style="width: auto;">
                <label for="newsletter" style="margin: 0;">Add my business to the Newsletter & Mailshot Database</label>
            </div>
            <div class="btn-nav">
                <button type="button" class="btn btn-prev" onclick="nextStep(2)">Back</button>
                <button type="submit" class="btn btn-success">Register Business</button>
            </div>
        </div>
    </form>
</div>

<footer>
    <p>&copy; 2026 Enterprise Room Business Hub. All Rights Reserved.</p>
</footer>

<script src="js/common.js"></script>
<script>
    function validateStep(stepNumber) {
        const step = document.getElementById('step' + stepNumber);
        const inputs = step.querySelectorAll('input[required], select[required], textarea[required]');
        let isValid = true;
        
        inputs.forEach(input => {
            if (!input.value.trim()) {
                isValid = false;
                input.style.borderColor = 'var(--live)';
                input.addEventListener('input', function() {
                    this.style.borderColor = '';
                }, { once: true });
            } else {
                input.style.borderColor = '';
            }
        });
        
        return isValid;
    }
    
    function nextStep(stepNumber) {
        // Validate current step before proceeding
        const currentStep = Array.from(document.querySelectorAll('.form-section')).findIndex(s => s.classList.contains('active')) + 1;
        if (stepNumber > currentStep && !validateStep(currentStep)) {
            alert('Please fill in all required fields before proceeding.');
            return;
        }
        
        // Hide all sections
        document.querySelectorAll('.form-section').forEach(section => {
            section.classList.remove('active');
        });
        // Show target section
        document.getElementById('step' + stepNumber).classList.add('active');
        
        // Update progress bar
        const progress = (stepNumber / 3) * 100;
        document.getElementById('progressBar').style.width = progress + '%';
        document.getElementById('currentStep').textContent = stepNumber;
        
        // If moving to step 3, populate review summary
        if (stepNumber === 3) {
            populateReviewSummary();
        }
        
        // Update indicators
        const steps = document.querySelectorAll('.step');
        steps.forEach((step, index) => {
            if (index + 1 <= stepNumber) {
                step.classList.add('active');
            } else {
                step.classList.remove('active');
            }
        });
        
        // Scroll to top of form
        document.getElementById('businessForm').scrollIntoView({ behavior: 'smooth', block: 'start' });
    }

    // Load user name from profile
    function loadUserName() {
        const userName = sessionStorage.getItem('userName');
        const userEmail = sessionStorage.getItem('userEmail');
        const registeredUsers = JSON.parse(localStorage.getItem('registeredUsers') || '{}');
        const userData = registeredUsers[userEmail];
        
        const ownerNameInput = document.getElementById('ownerName');
        if (ownerNameInput) {
            const name = userName || userData?.name || 'User';
            ownerNameInput.value = name;
        }
    }
    
    // Toggle CAC upload section
    function toggleCACUpload() {
        const cacRegistered = document.getElementById('cacRegistered').value;
        const cacUploadSection = document.getElementById('cacUploadSection');
        const cacCertificate = document.getElementById('cacCertificate');
        
        if (cacRegistered === 'yes') {
            cacUploadSection.style.display = 'block';
            cacCertificate.required = true;
        } else {
            cacUploadSection.style.display = 'none';
            cacCertificate.required = false;
            cacCertificate.value = '';
            document.getElementById('cacPreview').style.display = 'none';
        }
    }
    
    // Handle CAC certificate upload
    let cacCertificateData = null;
    function handleCACUpload(event) {
        const file = event.target.files[0];
        if (!file) return;
        
        // Validate file type
        const allowedTypes = ['application/pdf', 'image/jpeg', 'image/jpg', 'image/png'];
        if (!allowedTypes.includes(file.type)) {
            alert('Please upload a PDF, JPG, or PNG file.');
            event.target.value = '';
            return;
        }
        
        // Validate file size (max 5MB)
        if (file.size > 5 * 1024 * 1024) {
            alert('File size must be less than 5MB.');
            event.target.value = '';
            return;
        }
        
        const reader = new FileReader();
        reader.onload = function(e) {
            cacCertificateData = e.target.result;
            document.getElementById('cacPreview').style.display = 'block';
        };
        reader.readAsDataURL(file);
    }
    
    // Toggle bank details section
    function toggleBankDetails() {
        const hasBankAccount = document.getElementById('hasBusinessBankAccount').value;
        const bankDetailsSection = document.getElementById('bankDetailsSection');
        
        if (hasBankAccount === 'yes') {
            bankDetailsSection.style.display = 'block';
        } else {
            bankDetailsSection.style.display = 'none';
            // Clear bank details
            document.getElementById('bankName').value = '';
            document.getElementById('accountNumber').value = '';
            document.getElementById('accountName').value = '';
        }
    }
    
    // Populate review summary
    function populateReviewSummary() {
        const reviewSummary = document.getElementById('reviewSummary');
        const ownerName = document.getElementById('ownerName').value;
        const ownerRelationship = document.getElementById('ownerRelationship').value;
        const businessName = document.getElementById('businessName').value;
        const businessAddress = document.getElementById('businessAddress').value;
        const businessSector = document.getElementById('businessSector').value;
        const yearOfFormation = document.getElementById('yearOfFormation').value;
        const numberOfEmployees = document.getElementById('numberOfEmployees').value;
        const cacRegistered = document.getElementById('cacRegistered').value;
        const hasBankAccount = document.getElementById('hasBusinessBankAccount').value;
        
        reviewSummary.innerHTML = `
            <h4 style="margin-top: 0; color: var(--primary);">Owner Information</h4>
            <p><strong>Name:</strong> ${ownerName}</p>
            <p><strong>Relationship:</strong> ${ownerRelationship || 'Not specified'}</p>
            
            <h4 style="margin-top: 20px; color: var(--primary);">Business Information</h4>
            <p><strong>Business Name:</strong> ${businessName || 'Not specified'}</p>
            <p><strong>Address:</strong> ${businessAddress || 'Not specified'}</p>
            <p><strong>Sector:</strong> ${businessSector || 'Not specified'}</p>
            <p><strong>Year of Formation:</strong> ${yearOfFormation || 'Not specified'}</p>
            <p><strong>Number of Employees:</strong> ${numberOfEmployees || 'Not specified'}</p>
            <p><strong>CAC Registered:</strong> ${cacRegistered === 'yes' ? 'Yes' : cacRegistered === 'no' ? 'No' : 'Not specified'}</p>
            ${cacRegistered === 'yes' && cacCertificateData ? '<p><strong>CAC Certificate:</strong> ✓ Uploaded</p>' : ''}
            <p><strong>Business Bank Account:</strong> ${hasBankAccount === 'yes' ? 'Yes' : hasBankAccount === 'no' ? 'No' : 'Not specified'}</p>
        `;
    }

    document.getElementById('businessForm').onsubmit = function(e) {
        e.preventDefault();
        
        // Get current user email
        const userEmail = sessionStorage.getItem('userEmail');
        if (!userEmail) {
            alert('Error: You must be logged in to register a business.');
            window.location.href = 'login.html';
            return;
        }
        
        // Collect business data
        const businessData = {
            businessName: document.getElementById('businessName').value.trim(),
            businessAddress: document.getElementById('businessAddress').value.trim(),
            businessSector: document.getElementById('businessSector').value.trim(),
            yearOfFormation: document.getElementById('yearOfFormation').value.trim(),
            numberOfEmployees: parseInt(document.getElementById('numberOfEmployees').value) || 0,
            cacRegistered: document.getElementById('cacRegistered').value,
            cacCertificate: cacCertificateData || null,
            hasBusinessBankAccount: document.getElementById('hasBusinessBankAccount').value,
            bankName: document.getElementById('bankName')?.value.trim() || '',
            accountNumber: document.getElementById('accountNumber')?.value.trim() || '',
            accountName: document.getElementById('accountName')?.value.trim() || '',
            ownerName: document.getElementById('ownerName').value.trim(),
            ownerRelationship: document.getElementById('ownerRelationship').value.trim(),
            newsletter: document.getElementById('newsletter').checked,
            registeredDate: new Date().toISOString().split('T')[0],
            status: cacCertificateData ? 'Verified Business' : 'Pending Review',
            ownerEmail: userEmail // Link business to user
        };
        
        // Validate required fields
        if (!businessData.businessName || !businessData.businessAddress || !businessData.businessSector || 
            !businessData.yearOfFormation || !businessData.numberOfEmployees || !businessData.ownerRelationship) {
            alert('Please fill in all required fields.');
            return;
        }
        
        // Save business data to localStorage
        // Structure: { userEmail: [business1, business2, ...] }
        let businesses = JSON.parse(localStorage.getItem('registeredBusinesses') || '{}');
        
        // Generate unique ID for this business
        businessData.id = Date.now().toString() + Math.random().toString(36).substr(2, 9);
        
        // Initialize array if user has no businesses yet
        if (!businesses[userEmail]) {
            businesses[userEmail] = [];
        }
        
        // Add new business to user's business array
        businesses[userEmail].push(businessData);
        localStorage.setItem('registeredBusinesses', JSON.stringify(businesses));
        
        alert("Business registered successfully! Your business has been added to our database.");
        window.location.href = 'profile.html';
    };
    
    // Load user name on page load
    window.addEventListener('DOMContentLoaded', function() {
        loadUserName();
    });
</script>

</body>
</html>

